# Workflow de Despliegue - Todo App GCP

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                        WORKFLOW COMPLETO DE DESPLIEGUE                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. DESARROLLO LOCAL      โ
โ  Editar cรณdigo en src/app/โ
โ  - frontend/              โ
โ  - backend/               โ
โ  - db/                    โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. BUILD & PUSH IMAGES                   โ
โ  Script: ./scripts/push-images.fish       โ
โ                                           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โ  โ docker build todo-backend        โ    โ
โ  โ docker build todo-frontend       โ    โ
โ  โ docker build todo-db             โ    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โ                  โ                        โ
โ                  โผ                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โ  โ docker push smenaq/todo-backend  โ    โ
โ  โ docker push smenaq/todo-frontend โ    โ
โ  โ docker push smenaq/todo-db       โ    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. CREATE GKE CLUSTER (primera vez)      โ
โ  Script: ./scripts/create-cluster.fish    โ
โ                                           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โ  โ gcloud services enable           โ    โ
โ  โ gcloud container clusters create โ    โ
โ  โ   - 2 nodes e2-small            โ    โ
โ  โ   - autoscaling 2-3             โ    โ
โ  โ   - us-central1-a               โ    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โ                  โ                        โ
โ                  โผ                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โ  โ gcloud get-credentials           โ    โ
โ  โ kubectl cluster-info             โ    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  4. DEPLOY APPLICATION                     โ
โ  Script: ./scripts/deploy.fish             โ
โ                                            โ
โ  Ansible Playbook:                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ 1. Create namespace: todo-app      โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ               โ                            โ
โ               โผ                            โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ 2. Deploy Database (PostgreSQL)    โ   โ
โ  โ    - PVC 1Gi                       โ   โ
โ  โ    - Service ClusterIP             โ   โ
โ  โ    - Wait for ready                โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ               โ                            โ
โ               โผ                            โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ 3. Deploy Backend (Node.js)        โ   โ
โ  โ    - 2 replicas                    โ   โ
โ  โ    - Service ClusterIP             โ   โ
โ  โ    - Wait for ready                โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ               โ                            โ
โ               โผ                            โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ 4. Deploy Frontend (React+Nginx)   โ   โ
โ  โ    - 2 replicas                    โ   โ
โ  โ    - Service ClusterIP             โ   โ
โ  โ    - Wait for ready                โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ               โ                            โ
โ               โผ                            โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ 5. Deploy Ingress                  โ   โ
โ  โ    - Route / โ frontend            โ   โ
โ  โ    - Route /api โ backend          โ   โ
โ  โ    - Provision LoadBalancer        โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  5. WAIT FOR LOAD BALANCER IP (5-10 min)  โ
โ                                            โ
โ  kubectl get ingress -n todo-app           โ
โ                                            โ
โ  NAME                 ADDRESS              โ
โ  todo-app-ingress     34.123.45.67         โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  6. APPLICATION RUNNING โ                  โ
โ                                            โ
โ  http://34.123.45.67                       โ
โ                                            โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โ  Frontend (React)                โ     โ
โ  โ  โ API calls to /api             โ     โ
โ  โ  Backend (Node.js)               โ     โ
โ  โ  โ SQL queries                   โ     โ
โ  โ  Database (PostgreSQL)           โ     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                          ACTUALIZAR APLICACIรN                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. Hacer cambios en      โ
โ     src/app/*             โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. Push nuevas imรกgenes  โ
โ  ./scripts/push-images.fish 1.1.0
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. Redesplegar           โ
โ  ./scripts/deploy.fish --update
โ                           โ
โ  - kubectl rollout restartโ
โ  - Nuevos pods con v1.1.0 โ
โ  - Zero downtime          โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  4. Verificar             โ
โ  kubectl get pods -n todo-app
โ  kubectl logs ...         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                        LIMPIAR (EVITAR COSTOS)                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ./scripts/delete-cluster.fish
โ                           โ
โ  - Doble confirmaciรณn     โ
โ  - Elimina cluster        โ
โ  - Elimina Load Balancer  โ
โ  - Libera IPs             โ
โ  - Costos = $0            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                           RESUMEN DE SCRIPTS                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ฆ push-images.fish [version]
   โโ Construye y sube imรกgenes Docker a Docker Hub

๐๏ธ  create-cluster.fish
   โโ Crea cluster GKE en Google Cloud Platform

๐ deploy.fish [--update]
   โโ Despliega aplicaciรณn usando Ansible (deploy o redeploy)

๐๏ธ  delete-cluster.fish
   โโ Elimina cluster GKE para evitar costos


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                          COSTOS ESTIMADOS                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

GKE Cluster Management:  ~$74/mes
Load Balancer:           ~$18/mes
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
TOTAL:                   ~$92/mes

๐ Free Tier: $300 crรฉditos por 90 dรญas (nuevos usuarios)
   โ ~3 meses gratis de uso continuo

๐ก Consejo: Elimina el cluster cuando no lo uses para $0/mes
```
