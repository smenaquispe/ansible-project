---
# Variables globales para todos los playbooks
# Estas variables se aplican a todos los hosts

# ============================================================================
# DOCKER HUB CONFIGURATION
# ============================================================================
docker_user: smenaq
docker_registry: docker.io
default_image_version: latest

# Nombres de las imágenes
backend_image: "{{ docker_registry }}/{{ docker_user }}/todo-backend"
frontend_image: "{{ docker_registry }}/{{ docker_user }}/todo-frontend"
db_image: "{{ docker_registry }}/{{ docker_user }}/todo-db"

# ============================================================================
# GOOGLE CLOUD PLATFORM (GCP)
# ============================================================================
gcp_project_id: "ansible-project-475919"
gcp_zone: us-central1-a
gcp_region: us-central1

# ============================================================================
# KUBERNETES CLUSTER (GKE)
# ============================================================================
cluster_name: todo-app-cluster
machine_type: e2-small
num_nodes: 2

# Autoscaling de Nodos
min_nodes: 2
max_nodes: 5

# Límites de Recursos para Autoescalamiento
# GKE escalará el cluster para mantener entre estos límites
resource_limits:
  cpu:
    min: 4 # Mínimo de vCPUs en el cluster (e2-small tiene 2 vCPUs)
    max: 10 # Máximo de vCPUs en el cluster
  memory:
    min: 4 # Mínimo de GB de memoria en el cluster (e2-small tiene 2 GB)
    max: 10 # Máximo de GB de memoria en el cluster

# Políticas de Autoescalamiento
# GKE escala basado en la utilización de recursos de los pods
autoscaling_profile: balanced # balanced, optimize-utilization
cluster_autoscaler_settings:
  # Escalar cuando el uso de CPU de los pods alcanza este porcentaje
  cpu_utilization_target: 0.7 # 70% (valor entre 0.0 - 1.0)
  # Escalar cuando el uso de memoria de los pods alcanza este porcentaje
  memory_utilization_target: 0.8 # 80% (valor entre 0.0 - 1.0)
  # Tiempo de espera antes de escalar (segundos)
  scale_down_delay_after_add: 600 # 10 minutos
  scale_down_unneeded_time: 600 # 10 minutos
  # Control de escalado hacia abajo
  scale_down_utilization_threshold: 0.5 # 50%

# Disco
disk_size: 20 # GB
disk_type: pd-standard # pd-standard (HDD) o pd-ssd (SSD)

# Optimizaciones (deshabilitadas para reducir costos)
enable_cloud_logging: false
enable_cloud_monitoring: false

# Addons
cluster_addons:
  - HorizontalPodAutoscaling
  - HttpLoadBalancing

# ============================================================================
# KUBERNETES NAMESPACE & MANIFESTS
# ============================================================================
k8s_namespace: todo-app
k8s_manifests_dir_base: "{{ playbook_dir }}/../../kubernetes/base"
k8s_manifests_dir_gcp: "{{ playbook_dir }}/../../kubernetes/gcp"

# ============================================================================
# DEPLOYMENT CONFIGURATION
# ============================================================================
# Timeout para esperar que los pods estén listos (segundos)
pod_ready_timeout: 300
pod_ready_retries: 30
pod_ready_delay: 10

# Réplicas por servicio
# backend_replicas: 4
# frontend_replicas: 4
# db_replicas: 1

# ============================================================================
# KUBECONFIG
# ============================================================================
kubeconfig_path: "~/.kube/config"

# ============================================================================
# GCP AUTHENTICATION
# ============================================================================
# Ansible usará Application Default Credentials (ADC) por defecto
# Para configurar: gcloud auth application-default login
# O establecer: GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json
gcp_auth_kind: application
